<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Build Up 4 Exercises: Prepositions</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;500;700&family=Noto+Serif+JP:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans JP', 'Inter', sans-serif; }
        .en-font { font-family: 'Times New Roman', Times, serif !important; }
        .jp-font { font-family: 'Noto Serif JP', serif !important; }
        .control-button:hover { transform: scale(1.1); transition: transform 0.2s; }
        .highlight { color: #16A34A; font-weight: bold; }
        .recording { animation: pulse 1.5s infinite; }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(239, 68, 68, 0); }
            100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
        }
        .input-full {
            width: 100%; padding: 1.2rem; border: 2px solid #e5e7eb; border-radius: 0.5rem;
            margin-top: 0.5rem; font-size: 1.6rem; transition: all 0.2s;
            line-height: 1.4; display: block; resize: vertical;
        }
        .input-full:focus { border-color: #3b82f6; outline: none; box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2); }
        .input-full.correct { border-color: #16a34a; background-color: #f0fdf4; }
        .input-full.incorrect { border-color: #dc2626; background-color: #fef2f2; }
        .option-btn {
            display: block; width: 100%; text-align: left; padding: 1rem; margin-bottom: 0.5rem;
            background-color: #ffffff; border-radius: 0.5rem; font-size: 1.4rem; font-weight: 500;
            border: 2px solid #e5e7eb; transition: all 0.2s; cursor: pointer;
        }
        .option-btn:hover:not(:disabled) { background-color: #f8fafc; border-color: #cbd5e1; }
        .option-btn.correct { background-color: #dcfce7 !important; border-color: #16a34a !important; color: #14532d !important; }
        .option-btn.incorrect { background-color: #fee2e2 !important; border-color: #dc2626 !important; color: #7f1d1d !important; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900">
    <div class="container mx-auto p-4 sm:p-6 lg:p-8 max-w-4xl">
        <header class="text-center mb-10">
            <h1 class="text-3xl sm:text-4xl font-bold text-slate-800">Build Up 4 Exercises</h1>
            <p class="text-slate-600 mt-2 text-lg">å‰ç½®è© (Prepositions)</p>
        </header>

        <main class="space-y-12" id="main-content">
            <section class="bg-white rounded-2xl shadow-sm p-6 border border-slate-200">
                <h2 class="text-2xl font-bold text-blue-700 border-l-4 border-blue-500 pl-4 mb-6">1. é©åˆ‡ãªèªå¥ã®é¸æŠ</h2>
                <div id="sentences-1" class="space-y-8"></div>
            </section>

            <section class="bg-white rounded-2xl shadow-sm p-6 border border-slate-200">
                <h2 class="text-2xl font-bold text-green-700 border-l-4 border-green-500 pl-4 mb-6">2. é©åˆ‡ãªèªå¥ã®è£œå……</h2>
                <div id="sentences-2" class="space-y-8"></div>
            </section>

            <section class="bg-white rounded-2xl shadow-sm p-6 border border-slate-200">
                <h2 class="text-2xl font-bold text-amber-700 border-l-4 border-amber-500 pl-4 mb-6">3. èªå¥æ•´åº</h2>
                <div id="sentences-3" class="space-y-8"></div>
            </section>

            <section class="bg-white rounded-2xl shadow-sm p-6 border border-slate-200">
                <h2 class="text-2xl font-bold text-purple-700 border-l-4 border-purple-500 pl-4 mb-6">4. å’Œæ–‡è‹±è¨³</h2>
                <div id="sentences-4" class="space-y-8"></div>
            </section>
        </main>
    </div>

    <script>
        const sentences = [
            // Section 1: Multiple Choice
            {
                id: 1, category: '1',
                q: "( &emsp; ) the heavy traffic, I got to the office in time for the meeting.",
                en: "In spite of the heavy traffic, I got to the office in time for the meeting.",
                jp: "äº¤é€šæ¸‹æ»ã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€ä¼šè­°ã«é–“ã«åˆã†ã‚ˆã†ã«ä¼šç¤¾ã«ç€ã„ãŸã€‚",
                options: ["a. Due to", "b. In addition to", "c. In spite of", "d. Instead of"],
                answer: "c. In spite of",
                explanation: "é€†æ¥ã®å†…å®¹ãªã®ã§ in spite of ~ã€Œ~ã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€ã‚’ä½¿ã†ã€‚due to ~ ã¯ã€Œ~ã®ãŸã‚ã«ã€ã€in addition to ~ ã¯ã€Œ~ã«åŠ ãˆã¦ã€ã€instead of ã¯ã€Œ~ã®ä»£ã‚ã‚Šã«ã€ã€‚"
            },
            {
                id: 2, category: '1',
                q: "Mike doesn't look well. I'm really concerned ( &emsp; ) his health.",
                en: "Mike doesn't look well. I'm really concerned about his health.",
                jp: "ãƒã‚¤ã‚¯ã¯ä½“èª¿ãŒè‰¯ããªã•ãã†ã ã€‚ç§ã¯å½¼ã®å¥åº·ã‚’æœ¬å½“ã«å¿ƒé…ã—ã¦ã„ã‚‹ã€‚",
                options: ["a. about", "b. on", "c. of", "d. in"],
                answer: "a. about",
                explanation: "be concerned about ~ ã§ã€Œ~ã‚’å¿ƒé…ã—ã¦ã„ã‚‹ã€ã®æ„å‘³ã€‚be worried about ~ ã¨åŒã˜æ„å‘³ã‚’è¡¨ã™ã€‚"
            },
            {
                id: 3, category: '1',
                q: "We hope to see a couple of shows ( &emsp; ) our stay in New York City.",
                en: "We hope to see a couple of shows during our stay in New York City.",
                jp: "ãƒ‹ãƒ¥ãƒ¼ãƒ¨ãƒ¼ã‚¯å¸‚ã«æ»åœ¨ä¸­ã€ç§ãŸã¡ã¯2ã€3ã®ã‚·ãƒ§ãƒ¼ã‚’è¦‹ãŸã„ã€‚",
                options: ["a. for", "b. during", "c. by", "d. while"],
                answer: "b. during",
                explanation: "during ã¯å‰ç½®è©ã§ã€Œ(ç‰¹å®šã®æœŸé–“)ã®é–“ã«ã€ã‚’è¡¨ã™ã€‚while ã¯æ¥ç¶šè©ãªã®ã§ã€å¾Œã«S+Vã‚’ã¨ã‚‹ã€‚"
            },
            {
                id: 4, category: '1',
                q: "World War I began in 1914 and lasted ( &emsp; ) 1918.",
                en: "World War I began in 1914 and lasted until 1918.",
                jp: "ç¬¬ä¸€æ¬¡ä¸–ç•Œå¤§æˆ¦ã¯1914å¹´ã«å§‹ã¾ã‚Šã€1918å¹´ã¾ã§ç¶šã„ãŸã€‚",
                options: ["a. by", "b. for", "c. in", "d. until"],
                answer: "d. until",
                explanation: "last ã¯ã€Œç¶šãã€ã‚’æ„å‘³ã™ã‚‹è‡ªå‹•è©ãªã®ã§ã€ç¶™ç¶šã®çµ‚äº†ç‚¹ã‚’è¡¨ã™ untilã€Œã€œã¾ã§(ãšã£ã¨)ã€ã‚’é¸ã¶ã€‚by ã¯ã€Œã€œã¾ã§ã«ã€ã¨ã„ã†æœŸé™ã€‚"
            },
            {
                id: 5, category: '1',
                q: "The team's star player broke his leg and won't be able to play soccer ( &emsp; ) three months.",
                en: "The team's star player broke his leg and won't be able to play soccer for three months.",
                jp: "ãã®ãƒãƒ¼ãƒ ã®ã‚¹ã‚¿ãƒ¼é¸æ‰‹ã¯è„šã‚’éª¨æŠ˜ã—ãŸã®ã§ã€3ã‹æœˆé–“ã‚µãƒƒã‚«ãƒ¼ãŒã§ããªã„ã ã‚ã†ã€‚",
                options: ["a. during", "b. for", "c. until", "d. by"],
                answer: "b. for",
                explanation: "æ•°å­—ã‚’ä¼´ã£ãŸæœŸé–“(three months)ã‹ã‚‰ã€ç¶™ç¶šã™ã‚‹æœŸé–“ã‚’è¡¨ã™ forã€Œ~ã®é–“ã€ã‚’é¸ã¶ã€‚during ã¯ä¼‘æš‡ã®ã‚ˆã†ãªç‰¹å®šã®æœŸé–“ã€‚"
            },
            {
                id: 6, category: '1',
                q: "Anna came back from Japan ( &emsp; ) the morning of January 7.",
                en: "Anna came back from Japan on the morning of January 7.",
                jp: "ã‚¢ãƒ³ãƒŠã¯1æœˆ7æ—¥ã®æœã€æ—¥æœ¬ã‹ã‚‰æˆ»ã£ã¦æ¥ãŸã€‚",
                options: ["a. at", "b. on", "c. since", "d. until"],
                answer: "b. on",
                explanation: "on ã¯æ›œæ—¥ã‚„æ—¥ä»˜ã€ã‚ã‚‹ç‰¹å®šã®æ±ºã¾ã£ãŸæ—¥æ™‚ã‚’è¡¨ã™å ´åˆã«ä½¿ç”¨ã™ã‚‹ã€‚"
            },
            {
                id: 7, category: '1',
                q: "Is it possible for you to postpone today's meeting ( &emsp; ) next Wednesday?",
                en: "Is it possible for you to postpone today's meeting until next Wednesday?",
                jp: "ä»Šæ—¥ã®ä¼šè­°ã‚’æ¥é€±æ°´æ›œæ—¥ã¾ã§å»¶æœŸã—ã¦ã„ãŸã ãã“ã¨ã¯å¯èƒ½ã§ã™ã‹ã€‚",
                options: ["a. by", "b. in", "c. on", "d. until"],
                answer: "d. until",
                explanation: "until ~ã€Œ~ã¾ã§(ãšã£ã¨)ã€ã¯ã‚ã‚‹æ™‚ç‚¹ã¾ã§ã®ç¶™ç¶šã®çµ‚äº†ç‚¹ã‚’è¡¨ã™ã€‚"
            },
            {
                id: 8, category: '1',
                q: "Tom went there by car ( &emsp; ) by train.",
                en: "Tom went there by car instead of by train.",
                jp: "ãƒˆãƒ ã¯é›»è»Šã®ä»£ã‚ã‚Šã«è»Šã§ãã“ã«è¡Œã£ãŸã€‚",
                options: ["a. instead of", "b. with a view to", "c. in order to", "d. on account of"],
                answer: "a. instead of",
                explanation: "ã€Œ~ã®ä»£ã‚ã‚Šã«ã€ã¯ instead of ~ ã§è¡¨ã™ã€‚with a view to ã€Œã€œã™ã‚‹ç›®çš„ã§ã€ã€on account of ã€Œã€œã®ç†ç”±ã§ã€ã€‚"
            },
            {
                id: 9, category: '1',
                q: "The court will decide the extent ( &emsp; ) Mr. Suzuki is responsible for the livelihood of his former wife.",
                en: "The court will decide the extent to which Mr. Suzuki is responsible for the livelihood of his former wife.",
                jp: "éˆ´æœ¨æ°ãŒå‰å¦»ã®ç”Ÿæ´»ã«ã©ã®ç¨‹åº¦ã®è²¬ä»»ã‚’è² ã†ã‹ã«ã¤ã„ã¦ã€è£åˆ¤æ‰€ãŒæ±ºå®šã‚’ä¸‹ã™ã ã‚ã†ã€‚",
                options: ["a. at which", "b. of which", "c. in which", "d. to which"],
                answer: "d. to which",
                explanation: "extentã€Œç¯„å›²ã€ç¨‹åº¦ã€ã¨ã®çµ„ã¿åˆã‚ã›ã§ã‚ˆãä½¿ã†ã®ã¯ toã€Œã€œã¾ã§ã€ã€‚the extent to which S+V ã§ã€Œã©ã®ç¨‹åº¦ã€œã‹ã€ã€‚"
            },
            {
                id: 10, category: '1',
                q: "I failed math ( &emsp; ) science.",
                en: "I failed math in addition to science.",
                jp: "ç§‘å­¦ã«åŠ ãˆã¦æ•°å­¦ã‚‚ä¸åˆæ ¼ã ã£ãŸã€‚",
                options: ["a. in terms of", "b. in charge of", "c. on behalf of", "d. in addition to"],
                answer: "d. in addition to",
                explanation: "ã€Œ~ã«åŠ ãˆã¦ã€ã¯ in addition to ~ ã§è¡¨ã™ã€‚in terms of ã€Œã€œã®ç‚¹ã§ã€ã€on behalf of ã€Œã€œã‚’ä»£è¡¨ã—ã¦ã€ã€‚"
            },
            {
                id: 11, category: '1',
                q: "Mary was supposed to send an e-mail to her boss ( &emsp; ) midnight, but she must have forgotten.",
                en: "Mary was supposed to send an e-mail to her boss by midnight, but she must have forgotten.",
                jp: "ãƒ¡ã‚¢ãƒªãƒ¼ã¯çœŸå¤œä¸­ã¾ã§ã«ä¸Šå¸ã«ãƒ¡ãƒ¼ãƒ«ã‚’é€ã‚‹ã“ã¨ã«ãªã£ã¦ã„ãŸãŒã€å¿˜ã‚Œã¦ã—ã¾ã£ãŸã«é•ã„ãªã„ã€‚",
                options: ["a. by", "b. for", "c. in", "d. until"],
                answer: "a. by",
                explanation: "å‹•ä½œã®æœŸé™ãƒ»ç· ã‚åˆ‡ã‚Šã¯ byã€Œã€œã¾ã§ã«ã€ã§è¡¨ã™ã€‚until ã¯ç¶™ç¶šã‚’è¡¨ã™ã€‚"
            },
            {
                id: 12, category: '1',
                q: "I ran ( &emsp; ) my English teacher at the shopping mall yesterday.",
                en: "I ran across my English teacher at the shopping mall yesterday.",
                jp: "æ˜¨æ—¥ã€ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°ã‚»ãƒ³ã‚¿ãƒ¼ã§ç§ã®è‹±èªã®å…ˆç”Ÿã«å¶ç„¶å‡ºä¼šã£ãŸã€‚",
                options: ["a. of", "b. out", "c. away", "d. across"],
                answer: "d. across",
                explanation: "run across [run into / come across] ã€Œ~ã«å¶ç„¶å‡ºä¼šã†ã€ã®æ„å‘³ã€‚run out of ã€Œã€œã‚’ä½¿ã„æœãŸã™ã€ã€‚"
            },
            {
                id: 13, category: '1',
                q: "Because of rain, our excursion to Mount Aoba was ( &emsp; ) until next month.",
                en: "Because of rain, our excursion to Mount Aoba was put off until next month.",
                jp: "é›¨ã®ãŸã‚ã«ã€é’è‘‰å±±ã¸ã®é è¶³ã¯æ¥æœˆã¾ã§å»¶æœŸã«ãªã£ãŸã€‚",
                options: ["a. put away", "b. put off", "c. called up", "d. looked after"],
                answer: "b. put off",
                explanation: "put off ~ã€Œ~ã‚’å»¶æœŸã™ã‚‹ã€ã‚’é¸ã¶ã€‚put away ã€Œ~ã‚’ç‰‡ä»˜ã‘ã‚‹ã€ã€look after ã€Œ~ã®ä¸–è©±ã‚’ã™ã‚‹ã€ã€‚"
            },
            {
                id: 14, category: '1',
                q: "I went to the restaurant, ( &emsp; ) its bad reputation, because it was so cheap.",
                en: "I went to the restaurant, in spite of its bad reputation, because it was so cheap.",
                jp: "æ‚ªã„è©•åˆ¤ã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€ã¨ã¦ã‚‚å®‰ã„ã®ã§ãã®ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã¸è¡Œã£ãŸã€‚",
                options: ["a. by way of", "b. for want of", "c. in contrast to", "d. in spite of"],
                answer: "d. in spite of",
                explanation: "é€†æ¥ã®å†…å®¹ãªã®ã§ in spite of ã‚’ä½¿ã†ã€‚by way of ã€Œã€œçµŒç”±ã§ã€ã€for want of ã€Œã€œã®ä¸è¶³ã®ãŸã‚ã€ã€‚"
            },
            {
                id: 15, category: '1',
                q: "When planning your trip to a foreign country, you need to ( &emsp; ) safety into account.",
                en: "When planning your trip to a foreign country, you need to take safety into account.",
                jp: "å¤–å›½ã¸ã®æ—…è¡Œã‚’è¨ˆç”»ã™ã‚‹ã¨ãã¯ã€å®‰å…¨ã‚’è€ƒæ…®ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚",
                options: ["a. take", "b. look", "c. put", "d. see"],
                answer: "a. take",
                explanation: "take into account ã§ã€Œ~ã‚’è€ƒæ…®ã™ã‚‹ã€ã®æ„å‘³ã€‚"
            },

            // Section 2
            {
                id: 16, category: '2',
                q: "I've succeeded in business <u>&emsp;&emsp;&emsp;&emsp;</u> your help.",
                en: "I've succeeded in business thanks to your help.",
                jp: "ã‚ãªãŸã®åŠ©ã‘ã®ãŠã‹ã’ã§ã€ç§ã¯ä»•äº‹ã«æˆåŠŸã—ãŸã€‚",
                answer: "thanks to",
                explanation: "ã€Œ~ã®ãŠã‹ã’ã§ã€ã¯ç¾¤å‰ç½®è© thanks to ã‚’ç”¨ã„ã‚‹ã€‚"
            },
            {
                id: 17, category: '2',
                q: "Many people <u>&emsp;&emsp;&emsp;&emsp;</u> water.",
                en: "Many people asked for water.",
                jp: "æ°´ã‚’æ±‚ã‚ã‚‹äººãŒãŸãã•ã‚“ã„ãŸã€‚",
                answer: "asked for",
                explanation: "ã€Œ~ã‚’æ±‚ã‚ã‚‹ã€ã¯ç¾¤å‹•è© ask for ã§è¡¨ã™ã€‚"
            },
            {
                id: 18, category: '2',
                q: "I <u>&emsp;&emsp;&emsp;&emsp;</u> my host family.",
                en: "I heard from my host family.",
                jp: "ãƒ›ã‚¹ãƒˆãƒ•ã‚¡ãƒŸãƒªãƒ¼ã‹ã‚‰ä¾¿ã‚ŠãŒã‚ã£ãŸã€‚",
                answer: "heard from",
                explanation: "ã€Œ~ã‹ã‚‰ä¾¿ã‚ŠãŒã‚ã‚‹ã€ã¯ç¾¤å‹•è© hear from ã‚’ç”¨ã„ã‚‹ã€‚"
            },
            {
                id: 19, category: '2',
                q: "<u>&emsp;&emsp;&emsp;&emsp;</u> a specialist, the weather is extreme this year.",
                en: "According to a specialist, the weather is extreme this year.",
                jp: "ã‚ã‚‹å°‚é–€å®¶ã«ã‚ˆã‚‹ã¨ã€ä»Šå¹´ã®å¤©æ°—ã¯ç•°å¸¸ã ã€‚",
                answer: "according to",
                explanation: "ã€Œ~ã«ã‚ˆã‚‹ã¨ã€ã¯ç¾¤å‰ç½®è© according to ã§è¡¨ã™ã€‚"
            },

            // Section 3
            {
                id: 20, category: '3',
                q: "Average temperatures may increase <u>&emsp;&emsp;&emsp;&emsp;</u> decades.",
                en: "Average temperatures may increase by 2.5 degrees over the next two decades.",
                scrambled: "( 2.5 degrees / two / next / by / over / the )",
                jp: "ä»Šå¾Œ20å¹´ã§å¹³å‡æ°—æ¸©ãŒ2.5åº¦ä¸Šæ˜‡ã™ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚",
                answer: "by 2.5 degrees over the next two",
                explanation: "ã€Œ2.5åº¦(ã ã‘)ã€ã¨å·®ã‚’è¡¨ã™å ´åˆã€(by + æ•°è© + å˜ä½) ã‚’ä½¿ã†ã€‚over ã¯ã€Œã€œã®é–“ã«ã€ã‚’è¡¨ã™ã€‚"
            },
            {
                id: 21, category: '3',
                q: "You should read the newspaper <u>&emsp;&emsp;&emsp;&emsp;</u>.",
                en: "You should read the newspaper to keep up with current events.",
                scrambled: "( current / events / keep / to / up / with )",
                jp: "æ™‚äº‹å•é¡Œã«é€šã˜ã‚‹ãŸã‚ã«æ–°èã‚’èª­ã‚€ã¹ãã ã€‚",
                answer: "to keep up with current events",
                explanation: "ã€Œ~ã«é…ã‚Œãšã¤ã„ã¦è¡Œãã€ã¯ç¾¤å‹•è© keep up with ã§è¡¨ã™ã€‚"
            },
            {
                id: 22, category: '3',
                q: "I was looking for <u>&emsp;&emsp;&emsp;&emsp;</u>.",
                en: "I was looking for something to open the bottle with.",
                scrambled: "( bottle / something / with / to / the / open )",
                jp: "ç“¶ã‚’é–‹ã‘ã‚‹ã‚‚ã®ã‚’æ¢ã—ã¦ã„ãŸã€‚",
                answer: "something to open the bottle with",
                explanation: "é“å…·ã‚’è¡¨ã™ withã€Œ(é“å…·)ã‚’ä½¿ã£ã¦ã€ãŒå¿…è¦ã€‚"
            },
            {
                id: 23, category: '3',
                q: "When hot materials cool down, they <u>&emsp;&emsp;&emsp;&emsp;</u> energy.",
                en: "When hot materials cool down, they give off heat that can be used as energy.",
                scrambled: "( as / can be / give / heat that / off / used )",
                jp: "ç†±ã„ç‰©ä½“ãŒå†·ãˆã‚‹æ™‚ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¨ã—ã¦ä½¿ãˆã‚‹ç†±ã‚’æ”¾å‡ºã™ã‚‹ã€‚",
                answer: "give off heat that can be used as",
                explanation: "ã€Œ~ã‚’æ”¾å‡ºã™ã‚‹ã€ã¯ç¾¤å‹•è© give off ã§è¡¨ã™ã€‚"
            },

            // Section 4
            {
                id: 24, category: '4',
                en: "The teacher told us to hand in the paper by Monday.",
                jp: "å…ˆç”Ÿã¯ç§ãŸã¡ã«æœˆæ›œæ—¥ã¾ã§ã«ãƒ¬ãƒãƒ¼ãƒˆã‚’æå‡ºã™ã‚‹ã‚ˆã†ã«ã¨è¨€ã£ãŸã€‚",
                answer: "the teacher told us to hand in the paper by monday",
                explanation: "hand inã€Œã€œã‚’æå‡ºã™ã‚‹ã€ã‚’ç”¨ã„ã‚‹ã€‚ã€Œã€œã¾ã§ã«ã€ã¯æœŸé™ã® byã€‚"
            },
            {
                id: 25, category: '4',
                en: "The children kept playing until sunset.",
                jp: "å­ã©ã‚‚ãŸã¡ã¯æ—¥æ²¡ã¾ã§ãšã£ã¨éŠã‚“ã ã€‚",
                answer: "the children kept playing until sunset",
                explanation: "ã€Œã€œã¾ã§ãšã£ã¨ã€ã¯ç¶™ç¶šã‚’è¡¨ã™ until ã‚’ç”¨ã„ã‚‹ã€‚"
            },
            {
                id: 26, category: '4',
                en: "He kept me waiting for half an hour.",
                jp: "å½¼ã¯ç§ã‚’30åˆ†å¾…ãŸã›ãŸã€‚",
                answer: "he kept me waiting for half an hour",
                explanation: "ç¶™ç¶šã™ã‚‹æœŸé–“ã¯ for ã§è¡¨ã™ã€‚ã€Œ30åˆ†ã€ã¯ half an hour ã¾ãŸã¯ 30 minutesã€‚"
            },
            {
                id: 27, category: '4',
                en: "GDP stands for gross domestic product.",
                jp: "GDPã¯å›½å†…ç·ç”Ÿç”£ã‚’è¡¨ã—ã¦ã„ã‚‹ã€‚",
                answer: "gdp stands for gross domestic product",
                explanation: "ç¾¤å‹•è© stand for ã€Œ~ã‚’è¡¨ã™ã€ã‚’ç”¨ã„ã‚‹ã€‚"
            }
        ];

        // --- Application Logic ---
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        let recognition;
        let americanVoice = null;

        function loadVoices() {
            const voices = speechSynthesis.getVoices();
            americanVoice = voices.find(v => v.name.includes('Google US English')) || voices.find(v => v.lang === 'en-US');
        }
        speechSynthesis.onvoiceschanged = loadVoices;
        loadVoices();

        if (SpeechRecognition) {
            recognition = new SpeechRecognition();
            recognition.lang = 'en-US';
        }

        function normalize(t) {
            return t.toLowerCase().replace(/[.,\/#!$%\^&\*;:{}=\-_`~()]/g,"").replace(/\s+/g, ' ').trim();
        }

        function handleMic(text, btn, panel) {
            if (!recognition) return;
            if (btn.classList.contains('recording')) { recognition.stop(); return; }
            recognition.start();
            recognition.onstart = () => { btn.classList.add('recording', 'bg-red-500'); panel.innerHTML = "è´å–ä¸­..."; };
            recognition.onend = () => btn.classList.remove('recording', 'bg-red-500');
            recognition.onresult = (e) => {
                const transcript = e.results[0][0].transcript;
                panel.innerHTML = `çµæœ: ã€Œ${transcript}ã€`;
            };
        }

        function createCard(s, idx) {
            const card = document.createElement('div');
            card.className = 'bg-white p-6 rounded-xl border border-slate-100 shadow-sm relative';
            
            const header = document.createElement('div');
            header.className = 'flex justify-between items-start mb-4';
            header.innerHTML = `<span class="bg-slate-800 text-white w-10 h-10 rounded-full flex items-center justify-center font-bold text-xl">${idx}</span>`;
            
            const controls = document.createElement('div');
            controls.className = 'flex space-x-2';
            const speakBtn = document.createElement('button');
            speakBtn.className = 'p-3 bg-blue-100 text-blue-600 rounded-lg control-button text-xl';
            speakBtn.innerHTML = 'ğŸ”Š';
            speakBtn.onclick = () => {
                const u = new SpeechSynthesisUtterance(s.en);
                if (americanVoice) u.voice = americanVoice;
                speechSynthesis.speak(u);
            };
            const micBtn = document.createElement('button');
            micBtn.className = 'p-3 bg-green-100 text-green-600 rounded-lg control-button text-xl';
            micBtn.innerHTML = 'ğŸ¤';
            const micRes = document.createElement('div');
            micRes.className = 'text-xs text-slate-400 mt-1';
            micBtn.onclick = () => handleMic(s.en, micBtn, micRes);
            
            controls.append(speakBtn, micBtn);
            header.appendChild(controls);

            const body = document.createElement('div');
            body.className = 'space-y-4';
            
            const qText = document.createElement('div');
            qText.className = 'text-2xl text-slate-800 leading-relaxed en-font'; 
            qText.innerHTML = s.q || "";

            let input;
            let feedback = document.createElement('div');
            feedback.className = 'text-sm font-bold hidden py-2';
            
            const optButtons = [];

            if (s.category === '1') {
                const optContainer = document.createElement('div');
                optContainer.className = 'grid grid-cols-1 gap-2 mt-4';
                s.options.forEach(opt => {
                    const btn = document.createElement('button');
                    btn.className = 'option-btn en-font';
                    btn.textContent = opt;
                    btn.onclick = () => {
                        optButtons.forEach(b => b.classList.remove('correct', 'incorrect'));
                        const isCorrect = opt === s.answer;
                        btn.classList.add(isCorrect ? 'correct' : 'incorrect');
                        if (isCorrect) {
                            qText.innerHTML = s.en.replace(s.answer.split('. ')[1], `<span class="highlight">${s.answer.split('. ')[1]}</span>`);
                        }
                    };
                    optButtons.push(btn);
                    optContainer.appendChild(btn);
                });
                body.append(qText, optContainer);
            } else {
                input = (s.category === '3' || s.category === '4') ? document.createElement('textarea') : document.createElement('input');
                input.className = 'input-full en-font'; 
                input.placeholder = 'è§£ç­”ã‚’å…¥åŠ›';
                if (s.category === '3' || s.category === '4') {
                    input.rows = 2;
                }
                
                const checkBtn = document.createElement('button');
                checkBtn.className = 'mt-3 px-8 py-3 bg-slate-800 text-white rounded-lg font-bold text-lg hover:bg-slate-700 transition shadow-sm jp-font';
                checkBtn.textContent = 'ç­”ãˆåˆã‚ã›';
                
                checkBtn.onclick = () => {
                    const rawVal = input.value.trim();
                    const user = normalize(rawVal);
                    if (user === "") {
                        feedback.innerHTML = '<span class="text-amber-600 text-xl jp-font">è§£ç­”ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</span>';
                        feedback.classList.remove('hidden');
                        return;
                    }
                    const correct = normalize(s.answer);
                    const fullEn = normalize(s.en);
                    const isCorrect = (user === correct) || (user === fullEn) || (user.length > 5 && fullEn.includes(user));
                    input.className = `input-full en-font ${isCorrect ? 'correct' : 'incorrect'}`;
                    feedback.innerHTML = isCorrect ? '<span class="text-green-600 text-xl jp-font">æ­£è§£ã§ã™ï¼</span>' : '<span class="text-red-600 text-xl jp-font">ã‚‚ã†ä¸€åº¦ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</span>';
                    feedback.classList.remove('hidden');
                };
                
                body.append(qText, input, checkBtn, feedback);
            }

            const jpText = document.createElement('p');
            jpText.className = 'text-slate-600 text-2xl jp-font mt-2'; 
            jpText.textContent = s.jp;
            body.append(jpText);

            if (s.scrambled) {
                const scP = document.createElement('p');
                scP.className = 'text-2xl text-indigo-900 bg-indigo-50 p-4 rounded-lg border border-indigo-100 en-font'; 
                scP.textContent = s.scrambled;
                body.appendChild(scP);
            }

            const footer = document.createElement('div');
            footer.className = 'mt-6 flex flex-wrap items-center gap-3 border-t pt-4';

            const showBtn = document.createElement('button');
            showBtn.className = 'px-6 py-2 bg-slate-200 text-slate-800 rounded-lg text-lg font-bold hover:bg-slate-300 transition shadow-sm flex items-center gap-1.5 jp-font';
            showBtn.innerHTML = '<span>ğŸ‘ï¸</span> è§£ç­”è¡¨ç¤º';
            
            const expBtn = document.createElement('button');
            expBtn.className = 'px-6 py-2 bg-blue-50 text-blue-700 rounded-lg text-lg font-bold hover:bg-blue-100 transition border border-blue-200 shadow-sm flex items-center gap-1.5 jp-font';
            expBtn.innerHTML = '<span>ğŸ’¡</span> è§£èª¬ã‚’è¡¨ç¤º';
            
            const expPanel = document.createElement('div');
            expPanel.className = 'hidden w-full mt-3 p-5 bg-slate-50 rounded-lg text-xl text-slate-700 leading-relaxed border-l-4 border-slate-300 jp-font';
            expPanel.innerHTML = `<strong>è§£èª¬:</strong> ${s.explanation}`;

            showBtn.onclick = () => { 
                if (s.category === '1') {
                    // å¤§å•1ã®è§£ç­”è¡¨ç¤ºãƒ­ã‚¸ãƒƒã‚¯
                    optButtons.forEach(btn => {
                        btn.classList.remove('correct', 'incorrect');
                        if (btn.textContent === s.answer) {
                            btn.classList.add('correct');
                        }
                    });
                    const ansPart = s.answer.split('. ')[1];
                    qText.innerHTML = s.en.replace(ansPart, `<span class="highlight">${ansPart}</span>`);
                } else if (input) {
                    // å¤§å•2ã€œ4ã®è§£ç­”è¡¨ç¤ºãƒ­ã‚¸ãƒƒã‚¯
                    input.value = s.en; 
                    input.classList.add('correct'); 
                    input.classList.remove('incorrect');
                    feedback.classList.add('hidden');
                }
            };
            expBtn.onclick = () => expPanel.classList.toggle('hidden');

            footer.append(showBtn, expBtn);
            body.append(footer, expPanel, micRes);
            card.append(header, body);
            return card;
        }

        function render() {
            const containers = { '1': 'sentences-1', '2': 'sentences-2', '3': 'sentences-3', '4': 'sentences-4' };
            const counts = { '1': 0, '2': 0, '3': 0, '4': 0 };
            sentences.forEach(s => {
                counts[s.category]++;
                const container = document.getElementById(containers[s.category]);
                if (container) {
                    container.appendChild(createCard(s, counts[s.category]));
                }
            });
        }
        window.onload = render;
    </script>
</body>
</html>